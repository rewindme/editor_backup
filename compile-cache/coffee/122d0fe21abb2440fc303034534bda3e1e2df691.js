(function() {
  var $, OmniboxView, View, WebRenderFrames, _, _ref;

  _ref = require('atom-space-pen-views'), $ = _ref.$, View = _ref.View;

  OmniboxView = require('./omnibox-view');

  _ = require('underscore-plus');

  module.exports = WebRenderFrames = (function() {
    function WebRenderFrames() {
      this.objectMap = [];
      window.addEventListener('resize', this.repositionFrames.bind(this, false));
    }

    WebRenderFrames.prototype.createFrame = function(holder, url) {
      var el, height, left, offset, sticky_holder, top, webview, width;
      if ((_.where(this.objectMap, {
        holder: holder
      }).length)) {
        webview = _.where(this.objectMap, {
          holder: holder
        })[0];
        webview.src = 'about:blank';
        return webview;
      }
      webview = $("<webview plugins=\"on\" allowfullscreen=\"on\" autosize=\"on\" class=\"native-key-bindings\" />");
      webview.id = _.uniqueId("embed_webview_");
      sticky_holder = $('<div />').appendTo('body');
      $(sticky_holder).attr('id', _.uniqueId('webview_sticky_holder_'));
      $(sticky_holder).append(webview);
      $('body').append(sticky_holder);
      $(sticky_holder).css('width', '100%');
      $(sticky_holder).css('height', '100%');
      $(sticky_holder).css('position', 'fixed');
      el = holder;
      offset = $(el).offset();
      width = $(el).width();
      height = $(el).height();
      top = offset.top - $(window).scrollTop();
      left = offset.left - $(window).scrollLeft();
      $(sticky_holder).css('top', top + 'px');
      $(sticky_holder).css('left', left + 'px');
      $(sticky_holder).css('width', width + 'px');
      $(sticky_holder).css('height', height + 'px');
      this.objectMap.push({
        id: webview.id,
        sticky_holder: sticky_holder,
        webview: webview,
        holder: holder,
        measure: el
      });
      return webview;
    };

    WebRenderFrames.prototype.repositionFrames = function() {
      var el, frame, height, holder, left, offset, sticky_holder, top, width, _i, _len, _ref1, _results;
      if (!this.objectMap || this.objectMap.length === 0) {
        return;
      }
      _ref1 = this.objectMap;
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        frame = _ref1[_i];
        holder = el = frame.holder;
        sticky_holder = frame.sticky_holder;
        $(holder).css('position', 'absolute');
        offset = $(holder).offset();
        width = $(el).width();
        height = $(el).height();
        top = offset.top - $(window).scrollTop();
        left = offset.left - $(window).scrollLeft();
        $(sticky_holder).css('top', top + 'px');
        $(sticky_holder).css('left', left + 'px');
        $(sticky_holder).css('width', width + 'px');
        $(sticky_holder).css('height', height + 'px');
        if (holder.is(":visible")) {
          _results.push(holder.goVisible());
        } else {
          _results.push(holder.goInvisible());
        }
      }
      return _results;
    };

    WebRenderFrames.prototype.removeFrame = function(holder) {};

    WebRenderFrames.prototype.updateFrame = function(holder) {
      return this.repositionFrames();
    };

    return WebRenderFrames;

  })();

  atom.webRenderFrames || (atom.webRenderFrames = new WebRenderFrames());

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL1VzZXJzL25hdmVyLy5hdG9tL3BhY2thZ2VzL2F0b20td2ViYnJvd3Nlci9saWIvcmVuZGVyLWZyYW1lcy5jb2ZmZWUiCiAgXSwKICAibmFtZXMiOiBbXSwKICAibWFwcGluZ3MiOiAiQUFHQTtBQUFBLE1BQUEsOENBQUE7O0FBQUEsRUFBQSxPQUFhLE9BQUEsQ0FBUSxzQkFBUixDQUFiLEVBQUMsU0FBQSxDQUFELEVBQUksWUFBQSxJQUFKLENBQUE7O0FBQUEsRUFDQSxXQUFBLEdBQWMsT0FBQSxDQUFRLGdCQUFSLENBRGQsQ0FBQTs7QUFBQSxFQUVBLENBQUEsR0FBSSxPQUFBLENBQVEsaUJBQVIsQ0FGSixDQUFBOztBQUFBLEVBSUEsTUFBTSxDQUFDLE9BQVAsR0FDTTtBQUVTLElBQUEseUJBQUEsR0FBQTtBQUNYLE1BQUEsSUFBQyxDQUFBLFNBQUQsR0FBYSxFQUFiLENBQUE7QUFBQSxNQUNBLE1BQU0sQ0FBQyxnQkFBUCxDQUF3QixRQUF4QixFQUFrQyxJQUFDLENBQUEsZ0JBQWdCLENBQUMsSUFBbEIsQ0FBdUIsSUFBdkIsRUFBMEIsS0FBMUIsQ0FBbEMsQ0FEQSxDQURXO0lBQUEsQ0FBYjs7QUFBQSw4QkFLQSxXQUFBLEdBQWEsU0FBQyxNQUFELEVBQVMsR0FBVCxHQUFBO0FBRVgsVUFBQSw0REFBQTtBQUFBLE1BQUEsSUFBRyxDQUFDLENBQUMsQ0FBQyxLQUFGLENBQVEsSUFBQyxDQUFBLFNBQVQsRUFBb0I7QUFBQSxRQUFDLE1BQUEsRUFBTyxNQUFSO09BQXBCLENBQW9DLENBQUMsTUFBdEMsQ0FBSDtBQUNFLFFBQUEsT0FBQSxHQUFVLENBQUMsQ0FBQyxLQUFGLENBQVEsSUFBQyxDQUFBLFNBQVQsRUFBb0I7QUFBQSxVQUFDLE1BQUEsRUFBTyxNQUFSO1NBQXBCLENBQXFDLENBQUEsQ0FBQSxDQUEvQyxDQUFBO0FBQUEsUUFHQSxPQUFPLENBQUMsR0FBUixH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

//# sourceURL=/Users/naver/.atom/packages/atom-webbrowser/lib/render-frames.coffee
